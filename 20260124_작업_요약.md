# 🗓️ 작업 요약 보고서 (최종 수정: 2026-01-28 21:00)

## 🕒 2026-01-28 작업 내역 (재택 작업)
오늘 작업은 회사에서 진행하던 **금리 커브 시각화 앱(Streamlit)**의 미완성 부분을 보완하고, 누락된 핵심 라이브러리를 복구하는 데 집중하였습니다.

### 1. 📂 누락된 `basic_library` 복구 및 구조화 (완료)
- **문제**: 회사에서 `git add` 시 폴더 내 `.git` 존재 또는 기타 사유로 `basic_library` 폴더가 stage에서 제외되어 원격 저장소에 반영되지 않음. 이로 인해 `curve_viewer_app.py` 실행 시 임포트 에러 발생.
- **해결**: 재택 환경에서 기존 `oracle_*.py` 스크립트의 로직을 분석하여 `basic_library`를 수동으로 재구성함.
  - `basic_library/oracle_db.py`: Oracle Cloud DB 접속 및 데이터 조회(`get_available_curves`, `get_available_dates`, `get_all_curve_data`) 함수 구현.
  - `basic_library/tenor_conventions.py`: 테너 명칭(ON, 1M, 10Y 등)을 시각화용 Year Fraction으로 변환하는 로직 구현.
  - `basic_library/__init__.py`: 패키지 초기화 파일 생성.

### 2. 📊 코드 안정성 및 버그 수정
- **`oracle_db.py` 개선**: `pd.read_sql` 의존성 문제를 방지하기 위해 `cursor.fetchall()` 기반의 데이터 로딩 방식으로 변경하고, DSN을 대문자로 보정함.
- **`curve_viewer_app.py` 보완**: DB 데이터가 없을 경우(`available_curves`가 비어있을 때) 발생하는 런타임 에러 방지 로직 추가.
- **`oracle_test_connection.py` 수정**: 로컬/재택 환경에 따라 Wallet 경로를 자동으로 탐색하도록 지능형 경로 인식 로직 반영.
- **테스트 완료**: 테너 변환 로직(`test_basic_library.py`) 검증 완료.

---

## 🕒 2026-01-24 작업 내역
오늘 작업은 **로컬 개발 환경 구축**, **Supabase 인프라 최적화**, **대량의 금융 데이터(FICC) 통합**, 그리고 **시각화 분석 및 데이터 조회 제한 해결**을 중심으로 진행되었습니다.

---

## 1. 📁 프로젝트 및 환경 구축
- **Repository 클론**: `excel_handling` 프로젝트를 `C:\git_repository` 폴더에 성공적으로 클론하였습니다.
- **터미널 인코딩 최적화**: Windows PowerShell 환경에서 한글 깨짐 방지를 위해 코드 페이지를 `65001(UTF-8)`로 설정하였습니다.

## 2. 🛠️ Supabase CLI 설치 및 연동
- **CLI 설치**: GitHub 최신 릴리스에서 **Supabase CLI v2.72.7** 바이너리를 직접 다운로드하여 설치하였습니다. (`supabase.exe`)
- **인증 및 연동**: Access Token을 이용한 로그인 및 로컬 프로젝트 연동(`link`)을 완료하였습니다.

## 3. 🚀 FICC 데이터 통합 및 업로드
- **대량 업로드 (FICC Sample)**: `ficc_data_sample` 테이블에 **7,398건**의 데이터를 정제하여 업로드하였습니다. (결측치 해결 및 날짜 형식 변환 포함)
- **전 종목 과거 데이터 수집**: 2016년부터 2026년까지의 **전 종목 FICC 데이터(4,960건)**를 `data_from_infomax` 테이블에 `upsert` 방식으로 성공적으로 통합하였습니다.
- **데이터 중복 방지**: `date` + `code` 조합의 **Unique Key 제약 조건**을 추가하여 데이터 정밀도를 확보하였습니다.

## 4. 📈 데이터 시각화 및 조회 최적화 (핵심 해결 과제)
- **1Y/10Y 금리 비교 차트**: KRWQ3L1Y와 KRWQ3L10Y 종목의 10년치 추세를 비교하는 시각화 시스템을 구축하였습니다.
- **Supabase 1,000행 제한 문제 해결 (Pagination)**: 
  - **문제**: Supabase(PostgREST) 엔진의 기본 보안 설정으로 인해 한 번의 요청에 **최대 1,000개의 행**만 반환되는 제한이 확인되어, 10년치 대량 데이터(약 2,500건) 조회 시 데이터가 끊기는 현상이 발생하였습니다.
  - **해결**: `range(start, end)` 기반의 **페이지네이션(Pagination) 로직**을 도입하여, 1,000개씩 루프를 돌며 전체 데이터를 누락 없이 가져오도록 스크립트를 개선하였습니다.
- **실시간 데이터 검증**: 차트 생성 직전에 데이터의 최신 날짜(2026-01-23)와 총 건수를 터미널에 출력하도록 보강하였습니다.

---

## 📂 생성/수정된 주요 파일
- `basic_library/oracle_db.py`: Oracle DB 연동 모듈 (신규)
- `basic_library/tenor_conventions.py`: 테너 변환 유틸리티 (신규)
- `interactive_curve_chart/curve_viewer_app.py`: Streamlit 금리 커브 시각화 앱
- `supabase.exe`: Supabase CLI 실행 파일
- `upload_ficc_data.py`: FICC 데이터 정제 및 업로드 스크립트
- `plot_comparison_1y_10y.py`: 페이지네이션이 적용된 시각화 스크립트
- `check_latest_dates.py`: Supabase 데이터 최신성 검증 스크립트
- `20260124_작업_요약.md`: 현재 보고서

---
**보고자**: AI 코딩 어시스턴트
**상태**: 모든 데이터 수집 제한 문제 해결 및 분석 인프라 구축 완료 ✅
