# 🚀 메트라이프 변액보험 기준가 크롤러

## 📋 개요

메트라이프 웹사이트에서 **무배당 My Fund 변액유니버셜보험**의 **혼합성장형** 기준가 데이터를 자동으로 수집하여 엑셀로 저장합니다.

---

## ✅ 설치 완료!

모든 필수 라이브러리가 설치되었습니다:
- ✅ Selenium 4.39.0
- ✅ Pandas
- ✅ openpyxl  
- ✅ webdriver-manager

---

## 🎯 실행 방법 (3가지)

### **방법 1: BAT 파일 실행 (가장 쉬움!) ⭐**

1. **`RUN_METLIFE_CRAWLER.bat`** 파일 더블클릭
2. 명령 프롬프트 창이 열립니다
3. Chrome 브라우저가 자동으로 열립니다
4. 데이터 수집 과정을 지켜보세요 (~30초)
5. 완료! 엑셀 파일 생성됨

### **방법 2: CMD에서 실행**

```cmd
cd c:\git_repository\financeDataAccumulation
python metlife_crawler_simple.py
```

### **방법 3: PowerShell에서 실행**

```powershell
cd c:\git_repository\financeDataAccumulation
python metlife_crawler_simple.py
```

---

## 📊 수집되는 데이터

- **상품명**: 무배당 My Fund 변액유니버셜보험
- **펀드 유형**: 혼합성장형
- **조회 기간**: 최근 3개월
- **데이터 항목**:
  - 날짜
  - 기준가(원)

### 출력 파일
- **파일명**: `메트라이프_혼합성장형_기준가.xlsx`
- **형식**: Excel (.xlsx)
- **위치**: 현재 폴더

---

## 🔍 자동 작업 단계 (100% 완전 자동화)

1. ✅ 메트라이프 변액보험 공시 페이지 접속
2. ✅ "판매중지상품" 탭 클릭
3. ✅ "무배당 My Fund 변액유니버셜보험" 선택
4. ✅ 검색 버튼 클릭
5. ✅ 기준가현황 "보기" 클릭 **← 완전 자동화!**
6. ✅ "혼합성장형" 체크박스 선택
7. ✅ 검색기간 "3개월" 선택
8. ✅ 검색 후 데이터 수집
9. ✅ 엑셀 파일로 저장

**✨ 사용자 개입 없이 모든 단계가 자동으로 실행됩니다!**

**소요 시간**: 약 30초 ~ 1분

---

## 🛠 문제 해결

### 문제 1: Chrome 드라이버 오류

**증상**: `chromedriver` 관련 오류

**해결방법**:
```powershell
python -m pip install --upgrade webdriver-manager
```

### 문제 2: Chrome이 열리지 않음

**원인**: Chrome 브라우저 미설치 또는 구버전

**해결방법**:
1. Chrome 브라우저 설치 확인
2. Chrome 최신 버전으로 업데이트
3. Chrome 버전 확인: 주소창에 `chrome://version` 입력

### 문제 3: "모듈을 찾을 수 없음" 오류

**해결방법**:
```powershell
python -m pip install selenium pandas openpyxl webdriver-manager
```

### 문제 4: 요소를 찾을 수 없음

**원인**: 웹사이트 구조 변경

**해결방법**:
1. 간단 버전 실행: `python metlife_crawler_simple.py`
2. 각 단계의 출력 확인
3. 오류 발생 단계 파악
4. 수동으로 데이터 수집

---

## 💡 수동 데이터 수집 (크롤러 실패 시)

1. 웹사이트 접속: https://brand.metlife.co.kr/pn/paReal/retrieveVrinsPaBprcPcndList.do
2. "판매중지상품" 탭 클릭
3. 상품 검색에서 "무배당 My Fund 변액유니버셜보험" 선택
4. "검색" 버튼 클릭
5. "기준가현황" 열의 "보기" 링크 클릭
6. "혼합성장형" 체크박스 선택
7. "3개월" 버튼 클릭
8. "검색" 버튼 클릭
9. 결과 테이블 복사 → 엑셀 붙여넣기

---

## 🔧 커스터마이징

### 다른 펀드 유형 선택하기

`metlife_crawler_simple.py` 파일 수정:

```python
# 6단계 부분을 수정
# 예: 글로벌주식형 선택
for cb in checkboxes:
    try:
        parent = cb.find_element(By.XPATH, "..")
        if "글로벌주식형" in parent.text:  # <- 여기 수정
            if not cb.is_selected():
                cb.click()
```

### 다른 조회 기간 선택하기

```python
# 7단계 부분을 수정
# 예: 6개월 선택
six_months = driver.find_element(By.LINK_TEXT, "6개월")  # <- 여기 수정
six_months.click()
```

---

## 📈 데이터 활용 예시

### 1. 기본 통계 분석

```python
import pandas as pd

df = pd.read_excel('메트라이프_혼합성장형_기준가.xlsx')

# 기준가 정리 (쉼표 제거 및 숫자 변환)
df['기준가(원)'] = df['기준가(원)'].str.replace(',', '').astype(float)

print(f"평균 기준가: {df['기준가(원)'].mean():,.0f}원")
print(f"최고 기준가: {df['기준가(원)'].max():,.0f}원")
print(f"최저 기준가: {df['기준가(원)'].min():,.0f}원")
```

### 2. 수익률 계산

```python
# 기간 수익률
first_price = df.iloc[-1]['기준가(원)']
last_price = df.iloc[0]['기준가(원)']
return_rate = ((last_price - first_price) / first_price * 100)
print(f"3개월 수익률: {return_rate:+.2f}%")
```

### 3. 차트 그리기

```python
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm

# 한글 폰트 설정
plt.rcParams['font.family'] = 'Malgun Gothic'
plt.rcParams['axes.unicode_minus'] = False

plt.figure(figsize=(12, 6))
plt.plot(df['날짜'], df['기준가(원)'], marker='o', linewidth=2)
plt.title('메트라이프 My Fund 혼합성장형 기준가 추이', fontsize=16)
plt.xlabel('날짜', fontsize=12)
plt.ylabel('기준가(원)', fontsize=12)
plt.xticks(rotation=45)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('기준가_차트.png', dpi=300)
print("차트 저장: 기준가_차트.png")
```

---

## ⚠️ 주의사항

1. **웹사이트 변경**: 메트라이프 웹사이트 구조가 변경되면 크롤러가 작동하지 않을 수 있습니다.

2. **과도한 요청**: 너무 자주 실행하면 IP가 차단될 수 있습니다. 하루 1-2회 정도만 실행하세요.

3. **법적 문제**: 웹 크롤링은 법적 제한이 있을 수 있습니다. 개인 용도로만 사용하세요.

4. **Chrome 업데이트**: Chrome 브라우저가 업데이트되면 드라이버도 자동으로 업데이트됩니다.

---

## 📞 지원

문제가 발생하면:
1. `RUN_METLIFE_CRAWLER.bat` 파일을 실행하여 상세 로그 확인
2. 생성된 스크린샷 확인 (`error_*.png`)
3. Chrome 개발자 도구(F12)로 웹사이트 구조 확인

---

**마지막 업데이트**: 2026-01-10
**버전**: 1.0
